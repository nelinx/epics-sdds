#*************************************************************************
# Copyright (c) 2002 The University of Chicago, as Operator of Argonne
# National Laboratory.
# Copyright (c) 2002 The Regents of the University of California, as
# Operator of Los Alamos National Laboratory.
# This file is distributed subject to a Software License Agreement found
# in the file LICENSE that is included with this distribution. 
#*************************************************************************
#
# $Id: Makefile,v 1.3 2003-07-22 21:31:49 soliday Exp $
#

TOP=../../..
include $(TOP)/configure/CONFIG

CMPLR = ANSI

#RATIONAL = purify
#RATIONAL = quantify
#RATIONAL = purecov
ifdef RATIONAL
HOST_OPT = NO
CC := $(RATIONAL) -best-effort $(CC)
CCC := $(RATIONAL) -best-effort $(CCC)
endif

LIBRARY_HOST = lzma

ifeq ($(EPICS_HOST_ARCH),win32-x86)
USR_CFLAGS += -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_BSWAP_16 -DHAVE_BSWAP_32 -DHAVE_BSWAP_64 -DHAVE_DECL_PROGRAM_INVOCATION_NAME -DHAVE_VISIBILITY -DSIZEOF_SIZE_T=8 -DTUKLIB_FAST_UNALIGNED_ACCESS -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF -DEXPORT_LZMA /TP
endif
ifeq ($(EPICS_HOST_ARCH),windows-x64)
USR_CFLAGS += -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_BSWAP_16 -DHAVE_BSWAP_32 -DHAVE_BSWAP_64 -DHAVE_DECL_PROGRAM_INVOCATION_NAME -DHAVE_VISIBILITY -DSIZEOF_SIZE_T=8 -DTUKLIB_FAST_UNALIGNED_ACCESS -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF -DEXPORT_LZMA /TP
endif
ifeq ($(EPICS_HOST_ARCH),win32-x86-mingw)
USR_CFLAGS += -std=gnu99 -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_BSWAP_16 -DHAVE_BSWAP_32 -DHAVE_BSWAP_64 -DHAVE_DECL_PROGRAM_INVOCATION_NAME -DHAVE_VISIBILITY -DSIZEOF_SIZE_T=8 -DTUKLIB_FAST_UNALIGNED_ACCESS -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF     -DHAVE_STDBOOL_H
endif
ifeq ($(EPICS_HOST_ARCH),windows-x64-mingw)
USR_CFLAGS += -std=gnu99 -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_BSWAP_16 -DHAVE_BSWAP_32 -DHAVE_BSWAP_64 -DHAVE_DECL_PROGRAM_INVOCATION_NAME -DHAVE_VISIBILITY -DSIZEOF_SIZE_T=8 -DTUKLIB_FAST_UNALIGNED_ACCESS -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF     -DHAVE_STDBOOL_H
endif
ifeq ($(EPICS_HOST_ARCH),linux-x86)
USR_CFLAGS_Linux += -std=gnu99 -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_BSWAP_16 -DHAVE_BSWAP_32 -DHAVE_BSWAP_64 -DHAVE_BYTESWAP_H -DHAVE_DECL_PROGRAM_INVOCATION_NAME -DHAVE_VISIBILITY -DSIZEOF_SIZE_T=8 -DTUKLIB_FAST_UNALIGNED_ACCESS -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF -DHAVE_INTTYPES_H -DHAVE_STDBOOL_H -DHAVE_STRINGS_H -DHAVE_PTHREAD -DHAVE__BOOL
endif
ifeq ($(EPICS_HOST_ARCH),linux-x86_64)
USR_CFLAGS_Linux += -std=gnu99 -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_BSWAP_16 -DHAVE_BSWAP_32 -DHAVE_BSWAP_64 -DHAVE_BYTESWAP_H -DHAVE_DECL_PROGRAM_INVOCATION_NAME -DHAVE_VISIBILITY -DSIZEOF_SIZE_T=8 -DTUKLIB_FAST_UNALIGNED_ACCESS -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF -DHAVE_INTTYPES_H -DHAVE_STDBOOL_H -DHAVE_STRINGS_H -DHAVE_PTHREAD -DHAVE__BOOL
endif
ifeq ($(EPICS_HOST_ARCH),linux-ppc64)
USR_CFLAGS_Linux += -std=gnu99 -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_BSWAP_16 -DHAVE_BSWAP_32 -DHAVE_BSWAP_64 -DHAVE_BYTESWAP_H -DHAVE_DECL_PROGRAM_INVOCATION_NAME -DHAVE_VISIBILITY -DSIZEOF_SIZE_T=8 -DTUKLIB_FAST_UNALIGNED_ACCESS -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF -DHAVE_INTTYPES_H -DHAVE_STDBOOL_H -DHAVE_STRINGS_H -DHAVE_PTHREAD -DHAVE__BOOL
endif
ifeq ($(EPICS_HOST_ARCH),linux-ppc64-xl)
USR_CFLAGS_Linux += -std=gnu99 -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_BSWAP_16 -DHAVE_BSWAP_32 -DHAVE_BSWAP_64 -DHAVE_BYTESWAP_H -DHAVE_DECL_PROGRAM_INVOCATION_NAME -DHAVE_VISIBILITY -DSIZEOF_SIZE_T=8 -DTUKLIB_FAST_UNALIGNED_ACCESS -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF -DHAVE_INTTYPES_H -DHAVE_STDBOOL_H -DHAVE_STRINGS_H -DHAVE_PTHREAD -DHAVE__BOOL
endif
ifeq ($(EPICS_HOST_ARCH),solaris-sparc)
POSIX_CPPFLAGS=  
USR_CFLAGS_solaris += -D_STDC_C99= -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_DECL_PROGRAM_INVOCATION_NAME=0 -DHAVE_ICONV -DHAVE_SYS_BYTEORDER_H -DHAVE_VISIBILITY=0 -DSIZEOF_SIZE_T=4 -DWORDS_BIGENDIAN -D_FILE_OFFSET_BITS=64 -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF -DHAVE_INTTYPES_H -DHAVE_STDBOOL_H -DHAVE_STRINGS_H -DHAVE_PTHREAD -DHAVE__BOOL
endif
ifeq ($(EPICS_HOST_ARCH),solaris-sparc64)
POSIX_CPPFLAGS=  
USR_CFLAGS_solaris += -D_STDC_C99= -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_DECL_PROGRAM_INVOCATION_NAME=0 -DHAVE_ICONV -DHAVE_SYS_BYTEORDER_H -DHAVE_VISIBILITY=0 -DSIZEOF_SIZE_T=4 -DWORDS_BIGENDIAN -D_FILE_OFFSET_BITS=64 -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF -DHAVE_INTTYPES_H -DHAVE_STDBOOL_H -DHAVE_STRINGS_H -DHAVE_PTHREAD -DHAVE__BOOL
endif
ifeq ($(EPICS_HOST_ARCH),solaris-sparc-gnu)
POSIX_CPPFLAGS=  
USR_CFLAGS_solaris += -std=gnu99 -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_DECL_PROGRAM_INVOCATION_NAME=0 -DHAVE_ICONV -DHAVE_SYS_BYTEORDER_H -DHAVE_VISIBILITY -DSIZEOF_SIZE_T=4 -DWORDS_BIGENDIAN -D_FILE_OFFSET_BITS=64 -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF -DHAVE_INTTYPES_H -DHAVE_STDBOOL_H -DHAVE_STRINGS_H -DHAVE_PTHREAD -DHAVE__BOOL
endif
ifeq ($(EPICS_HOST_ARCH),solaris-sparc64-gnu)
POSIX_CPPFLAGS=  
USR_CFLAGS_solaris += -std=gnu99 -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_DECL_PROGRAM_INVOCATION_NAME=0 -DHAVE_ICONV -DHAVE_SYS_BYTEORDER_H -DHAVE_VISIBILITY -DSIZEOF_SIZE_T=4 -DWORDS_BIGENDIAN -D_FILE_OFFSET_BITS=64 -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF -DHAVE_INTTYPES_H -DHAVE_STDBOOL_H -DHAVE_STRINGS_H -DHAVE_PTHREAD -DHAVE__BOOL
endif
ifeq ($(EPICS_HOST_ARCH),solaris-x86)
POSIX_CPPFLAGS=  
USR_CFLAGS_solaris += -D_STDC_C99= -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_DECL_PROGRAM_INVOCATION_NAME=0 -DHAVE_ICONV -DHAVE_SYS_BYTEORDER_H -DHAVE_VISIBILITY=0 -DSIZEOF_SIZE_T=4 -DTUKLIB_FAST_UNALIGNED_ACCESS -D_FILE_OFFSET_BITS=64 -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF -DHAVE_INTTYPES_H -DHAVE_STDBOOL_H -DHAVE_STRINGS_H -DHAVE_PTHREAD -DHAVE__BOOL
endif
ifeq ($(EPICS_HOST_ARCH),solaris-x86_64)
POSIX_CPPFLAGS=  
USR_CFLAGS_solaris += -D_STDC_C99= -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_DECL_PROGRAM_INVOCATION_NAME=0 -DHAVE_ICONV -DHAVE_SYS_BYTEORDER_H -DHAVE_VISIBILITY=0 -DSIZEOF_SIZE_T=4 -DTUKLIB_FAST_UNALIGNED_ACCESS -D_FILE_OFFSET_BITS=64 -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF -DHAVE_INTTYPES_H -DHAVE_STDBOOL_H -DHAVE_STRINGS_H -DHAVE_PTHREAD -DHAVE__BOOL
endif
ifeq ($(EPICS_HOST_ARCH),solaris-x86-gnu)
POSIX_CPPFLAGS=  
USR_CFLAGS_solaris += -std=gnu99 -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_DECL_PROGRAM_INVOCATION_NAME=0 -DHAVE_ICONV -DHAVE_SYS_BYTEORDER_H -DHAVE_VISIBILITY -DSIZEOF_SIZE_T=4 -DTUKLIB_FAST_UNALIGNED_ACCESS -D_FILE_OFFSET_BITS=64 -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF -DHAVE_INTTYPES_H -DHAVE_STDBOOL_H -DHAVE_STRINGS_H -DHAVE_PTHREAD -DHAVE__BOOL
endif
ifeq ($(EPICS_HOST_ARCH),solaris-x86_64-gnu)
POSIX_CPPFLAGS=  
USR_CFLAGS_solaris += -std=gnu99 -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_DECL_PROGRAM_INVOCATION_NAME=0 -DHAVE_ICONV -DHAVE_SYS_BYTEORDER_H -DHAVE_VISIBILITY -DSIZEOF_SIZE_T=4 -DTUKLIB_FAST_UNALIGNED_ACCESS -D_FILE_OFFSET_BITS=64 -DHAVE_DCGETTEXT -DHAVE_FUTIMENS -DHAVE_GETTEXT -DHAVE_STRUCT_STAT_ST_ATIM_TV_NSEC -DTUKLIB_CPUCORES_SYSCONF -DTUKLIB_PHYSMEM_SYSCONF -DHAVE_INTTYPES_H -DHAVE_STDBOOL_H -DHAVE_STRINGS_H -DHAVE_PTHREAD -DHAVE__BOOL
endif
ifeq ($(EPICS_HOST_ARCH),darwin-x86)
USR_CFLAGS_Darwin += -std=gnu99 -DHAVE_CONFIG_H -DTUKLIB_SYMBOL_PREFIX=lzma_ -DHAVE_CFLOCALECOPYCURRENT -DHAVE_CFPREFERENCESCOPYAPPVALUE -DHAVE_DECL_PROGRAM_INVOCATION_NAME=0 -DHAVE_ICONV -DHAVE_VISIBILITY -DSIZEOF_SIZE_T=8 -DTUKLIB_FAST_UNALIGNED_ACCESS -DHAVE_FUTIMES -DHAVE_OPTRESET -DHAVE_STRUCT_STAT_ST_ATIMESPEC_TV_NSEC -DTUKLIB_CPUCORES_SYSCTL -DTUKLIB_PHYSMEM_SYSCTL -DHAVE_INTTYPES_H -DHAVE_STDBOOL_H -DHAVE_STRINGS_H -DHAVE_PTHREAD -DHAVE__BOOL
endif

LIBSRCS = alone_decoder.c \
	alone_encoder.c \
	arm.c \
	armthumb.c \
	auto_decoder.c \
	block_buffer_decoder.c \
	block_buffer_encoder.c \
	block_decoder.c \
	block_encoder.c \
	block_header_decoder.c \
	block_header_encoder.c \
	block_util.c \
	check.c \
	common.c \
	crc32_fast.c \
	crc32_table.c \
	crc64_fast.c \
	crc64_table.c \
	delta_common.c \
	delta_decoder.c \
	delta_encoder.c \
	easy_buffer_encoder.c \
	easy_decoder_memusage.c \
	easy_encoder.c \
	easy_encoder_memusage.c \
	easy_preset.c \
	fastpos_table.c \
	filter_buffer_decoder.c \
	filter_buffer_encoder.c \
	filter_common.c \
	filter_decoder.c \
	filter_encoder.c \
	filter_flags_decoder.c \
	filter_flags_encoder.c \
	hardware_physmem.c \
	ia64.c \
	index.c \
	index_decoder.c \
	index_encoder.c \
	index_hash.c \
	lz_decoder.c \
	lz_encoder.c \
	lz_encoder_mf.c \
	lzma2_decoder.c \
	lzma2_encoder.c \
	lzma_decoder.c \
	lzma_encoder.c \
	lzma_encoder_optimum_fast.c \
	lzma_encoder_optimum_normal.c \
	lzma_encoder_presets.c \
	powerpc.c \
	price_table.c \
	sha256.c \
	simple_coder.c \
	simple_decoder.c \
	simple_encoder.c \
	sparc.c \
	stream_buffer_decoder.c \
	stream_buffer_encoder.c \
	stream_decoder.c \
	stream_encoder.c \
	stream_flags_common.c \
	stream_flags_decoder.c \
	stream_flags_encoder.c \
	tuklib_physmem.c \
	vli_decoder.c \
	vli_encoder.c \
	vli_size.c \
	x86.c


include $(TOP)/configure/RULES
